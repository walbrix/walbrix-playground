#noaufs
#require gentoo.lst

## emerge necessary components
#copy oscar/build.sh /build.sh
#chrootexec sh /build.sh && rm /build.sh

## system setup
#sed /etc/conf.d/hostname s/^hostname=.*$/hostname="oscar-dev"/
#chrootexec useradd -m oscar
#chrootexec groupmems -g cron -a oscar
#chrootexec groupmems -g wheel -a oscar
#sed /etc/sudoers s/^# \(\%wheel ALL=(ALL) NOPASSWD: ALL\)$/\1/
##copy oscar/oscar.include /etc/apache2/vhosts.d/oscar.include
##patchsinglefile /etc/apache2/vhosts.d/00_default_vhost.conf oscar/00_default_vhost.conf.patch
#symlink /etc/runlevels/default/vixie-cron /etc/init.d/vixie-cron
#copy oscar/sysctl-groonga.conf /etc/sysctl.d/groonga.conf
#copy oscar/sysctl-oscar.conf /etc/sysctl.d/oscar.conf

## Samba
#copy oscar/smb.conf /etc/samba/smb.conf
#chrootexec chmod g+rwx /var/lib/samba/private
#chrootexec smbpasswd -an
#chrootexec chmod g+rw /var/lib/samba/private/passdb.tdb
#chrootexec chgrp -R oscar /var/lib/samba/private

## Apache
#sed /etc/conf.d/apache2 s/^\(APACHE2_OPTS=.*\)\"$/\1 -D WSGI"/
#symlink /etc/runlevels/default/apache2 /etc/init.d/apache2

## groonga
#chrootexec cd /root && wget http://packages.groonga.org/source/groonga/groonga-4.0.3.tar.gz && tar xvzf groonga-*.tar.gz && cd groonga-*/ && ./configure --prefix=/usr --localstatedir=/var && make && make install && cd .. && rm -rf groonga-*/

## oscar
#chrootexec cd /root && git clone https://github.com/shimarin/oscar.git && cd oscar && make install && cd .. && rm -rf oscar
#copy oscar/oscar-watcher.init /etc/init.d/oscar-watcher
#copy oscar/oscar-sync.init /etc/init.d/oscar-sync
#chrootexec chmod 755 /etc/init.d/oscar-watcher
#chrootexec chmod 755 /etc/init.d/oscar-sync
#symlink /etc/runlevels/default/oscar-watcher /etc/init.d/oscar-watcher
#symlink /etc/runlevels/default/oscar-sync /etc/init.d/oscar-sync

## clamav
#chrootexec freshclam --no-warnings
#sed /etc/conf.d/clamd s/^START_CLAMD=.\+/START_CLAMD=no/
#symlink /etc/runlevels/default/clamav /etc/init.d/clamav

